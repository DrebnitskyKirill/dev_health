/*! For license information please see 25.bundle.js.LICENSE.txt */
(self.webpackChunkdev_health=self.webpackChunkdev_health||[]).push([[25],{551:()=>{},1140:(t,e,r)=>{"use strict";r.d(e,{J:()=>i});var n="undefined"!=typeof window,o=n&&window.location&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),i=n&&window.__API_BASE_URL__||(o?"http://localhost:3001/api":"/api")},1234:()=>{},4530:()=>{},5817:()=>{},8108:()=>{},8590:()=>{},8809:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>T});var n=r(6540),o=(r(8551),r(8560)),i=r(1140),a=r(7428);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,s=Object.create(u.prototype);return l(s,"_invoke",function(r,n,o){var i,c,u,l=0,s=o||[],f=!1,m={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return i=e,c=0,u=t,m.n=r,a}};function d(r,n){for(c=r,u=n,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=m.p,p=i[2];r>3?(o=p===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,m.v=n,m.n=i[1]):d<p&&(o=r<3||i[0]>n||n>p)&&(i[4]=r,i[5]=n,m.n=p,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,p),c=s,u=p;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(m.n=-1),d(c,u)):m.n=u:m.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=m.n<0)?u:r.call(n,m))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(r,o,i),!0),s}var a={};function c(){}function s(){}function f(){}e=Object.getPrototypeOf;var m=[][n]?e(e([][n]())):(l(e={},n,function(){return this}),e),d=f.prototype=c.prototype=Object.create(m);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=f,l(d,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(d),l(d,o,"Generator"),l(d,n,function(){return this}),l(d,"toString",function(){return"[object Generator]"}),(u=function(){return{w:i,m:p}})()}function l(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}l=function(t,e,r,n){function i(e,r){l(t,e,function(t){return this._invoke(e,r,t)})}e?o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(i("next",0),i("throw",1),i("return",2))},l(t,e,r,n)}function s(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach(function(e){d(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function d(t,e,r){return(e=function(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var v=1200,y=function(){var t,e,r=(0,o.A)(),c=r.user,l=r.token,f=(0,a.o)().t,d=(t=(0,n.useState)(function(){try{var t=localStorage.getItem("visionReminderState");if(t)return JSON.parse(t)}catch(t){console.error("Error loading reminder state:",t)}return{seconds:v,isActive:!1,remindersShown:0,startTime:null}}),e=2,function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return p(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=d[0],b=d[1],h=(0,n.useRef)(null),g=(0,n.useCallback)(function(t){try{localStorage.setItem("visionReminderState",JSON.stringify(t))}catch(t){console.error("Error saving reminder state:",t)}},[]),w=(0,n.useCallback)(function(t){b(function(e){var r=m(m({},e),t);return g(r),r})},[g]),x=(0,n.useCallback)(function(t,e){try{if(!("Notification"in window))return;window.Notification(t,{body:e,tag:"vision-reminder"})}catch(t){}},[]);(0,n.useEffect)(function(){"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[]);var S=function(){var t,e=(t=u().m(function t(){var e;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:if(c&&l){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,fetch("".concat(i.J,"/gamification/update-statistics"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)},body:JSON.stringify({blinkReminders:1})});case 2:t.n=4;break;case 3:t.p=3,e=t.v,console.error("Error updating statistics:",e);case 4:return t.a(2)}},t,null,[[1,3]])}),function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){s(i,n,o,a,c,"next",t)}function c(t){s(i,n,o,a,c,"throw",t)}a(void 0)})});return function(){return e.apply(this,arguments)}}();(0,n.useEffect)(function(){return y.isActive?h.current=setInterval(function(){b(function(t){var e=t.seconds-1;if(e<=0){E();var r=m(m({},t),{},{seconds:v,isActive:!1,startTime:null,remindersShown:t.remindersShown+1});return g(r),r}var n=m(m({},t),{},{seconds:e});return g(n),n})},1e3):h.current&&clearInterval(h.current),function(){h.current&&clearInterval(h.current)}},[y.isActive,g]);var E=function(){S(),x("Vision Reminder!","Look at something 20 feet away for 20 seconds!")},O=Math.floor(y.seconds/60).toString().padStart(2,"0"),j=(y.seconds%60).toString().padStart(2,"0");return n.createElement("div",{className:"flex flex-col items-center gap-4 p-6 bg-white rounded-lg shadow-lg max-w-sm w-full"},n.createElement("div",{className:"text-center mb-4"},n.createElement("div",{className:"text-lg font-semibold mb-2"},"Vision Reminder"),n.createElement("div",{className:"text-4xl md:text-6xl font-mono font-bold text-gray-800 mb-2"},O,":",j),n.createElement("div",{className:"text-sm text-gray-600"},"Every 20 minutes â€” 20 seconds looking into the distance")),n.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-left mb-4 w-full"},n.createElement("h3",{className:"font-semibold text-green-900 mb-2"},"ðŸ’¡ ",f("vision.whyImportant.title")),n.createElement("p",{className:"text-sm text-green-800"},f("vision.whyImportant.subtitle")),n.createElement("ul",{className:"text-sm text-green-800 mt-2 space-y-1"},n.createElement("li",null,"â€¢ ",f("vision.whyImportant.rule")),n.createElement("li",null,"â€¢ ",f("vision.whyImportant.duration")),n.createElement("li",null,"â€¢ ",f("vision.whyImportant.strain")),n.createElement("li",null,"â€¢ ",f("vision.whyImportant.computer")))),n.createElement("div",{className:"flex gap-2 mb-4"},n.createElement("button",{onClick:function(){return y.isActive?void w({isActive:!1,startTime:null}):void w({isActive:!0,startTime:Date.now()})},style:{cursor:"pointer"},className:"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium"},y.isActive?"Pause":"Start"),n.createElement("button",{onClick:function(){w({seconds:v,isActive:!1,startTime:null,remindersShown:0})},style:{cursor:"pointer"},className:"px-6 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 transition-colors font-medium"},"Reset")),n.createElement("div",{className:"w-full bg-gray-50 rounded-lg p-4"},n.createElement("div",{className:"text-center"},n.createElement("div",{className:"text-2xl font-bold text-blue-600"},"Reminders Shown: ",y.remindersShown))),c&&n.createElement("div",{className:"text-center text-sm text-gray-500 mt-2"},"ðŸ’¡ ",f("vision.earnPoints")),n.createElement("div",{className:"text-xs text-gray-500 text-center mt-2"},f("vision.ruleDescription")))},b=r(60),h=r.n(b),g=r(2007),w=(r(8536),r(3476));function x(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var u=n&&n.prototype instanceof c?n:c,l=Object.create(u.prototype);return S(l,"_invoke",function(r,n,o){var i,c,u,l=0,s=o||[],f=!1,m={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return i=e,c=0,u=t,m.n=r,a}};function d(r,n){for(c=r,u=n,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=m.p,p=i[2];r>3?(o=p===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,m.v=n,m.n=i[1]):d<p&&(o=r<3||i[0]>n||n>p)&&(i[4]=r,i[5]=n,m.n=p,c=0))}if(o||r>1)return a;throw f=!0,n}return function(o,s,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,p),c=s,u=p;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(m.n=-1),d(c,u)):m.n=u:m.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=m.n<0)?u:r.call(n,m))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(r,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][n]?e(e([][n]())):(S(e={},n,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,S(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,S(f,"constructor",l),S(l,"constructor",u),u.displayName="GeneratorFunction",S(l,o,"GeneratorFunction"),S(f),S(f,o,"Generator"),S(f,n,function(){return this}),S(f,"toString",function(){return"[object Generator]"}),(x=function(){return{w:i,m}})()}function S(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}S=function(t,e,r,n){function i(e,r){S(t,e,function(t){return this._invoke(e,r,t)})}e?o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(i("next",0),i("throw",1),i("return",2))},S(t,e,r,n)}function E(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function O(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){E(i,n,o,a,c,"next",t)}function c(t){E(i,n,o,a,c,"throw",t)}a(void 0)})}}function j(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return N(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?N(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function k(t){var e=function(t,e){return Math.hypot(t.x-e.x,t.y-e.y)},r=e(t[1],t[5])+e(t[2],t[4]),n=2*e(t[0],t[3]);return 0===n?0:r/n}var P=function(){var t=(0,n.useRef)(null),e=(0,n.useRef)(null),r=j((0,n.useState)(0),2),o=r[0],i=r[1],a=j((0,n.useState)(0),2),c=a[0],u=a[1],l=j((0,n.useState)(!1),2),s=l[0],f=l[1],m=j((0,n.useState)("idle"),2),d=m[0],p=m[1],v=(0,n.useMemo)(function(){return{width:480,height:360,facingMode:"user"}},[]);return(0,n.useEffect)(function(){var r=null,n=[],o=0,a=function(){var a=O(x().m(function a(){var c;return x().w(function(a){for(;;)switch(a.p=a.n){case 0:return a.p=0,a.n=1,g.jh6("webgl");case 1:return a.n=2,g.Gc4();case 2:return a.n=3,w.Fz(w.JZ.MediaPipeFaceMesh,{runtime:"mediapipe",refineLandmarks:!0,solutionPath:"https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh"});case 3:c=a.v,e.current=c,p("running"),r=window.setInterval(O(x().m(function e(){var r,a,l,m,d,p,v,y,b,h,g,w,S,E;return x().w(function(e){for(;;)switch(e.n){case 0:if((r=t.current)&&r.video){e.n=1;break}return e.a(2);case 1:if(!((a=r.video).readyState<2)){e.n=2;break}return e.a(2);case 2:return e.n=3,c.estimateFaces(a,{flipHorizontal:!0});case 3:if(l=e.v,(m=null==l?void 0:l[0])&&m.keypoints){e.n=4;break}return e.a(2);case 4:d=[33,160,158,133,153,144],p=[362,385,387,263,373,380],v=m.keypoints,y=d.map(function(t){return{x:v[t].x,y:v[t].y}}),b=p.map(function(t){return{x:v[t].x,y:v[t].y}}),h=k(y),g=k(b),i(w=(h+g)/2),S=Date.now(),w<.22&&!s&&f(!0),w>=.22&&s&&(f(!1),o+=1),n.push(S),n=n.filter(function(t){return S-t<=6e4}),E=o/Math.max(1,150*n.length/6e4),u(Math.round(E)),S%5e3<150&&fetch("/api/blink-events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({blinksPerMin:Math.round(E)})}).catch(function(){});case 5:return e.a(2)}},e)})),150),a.n=5;break;case 4:a.p=4,a.v,p("error");case 5:return a.a(2)}},a,null,[[0,4]])}));return function(){return a.apply(this,arguments)}}();return a(),function(){r&&window.clearInterval(r),e.current=null}},[s]),n.createElement("div",{className:"grid gap-3"},n.createElement("div",{className:"text-sm"},"Status: ",d),n.createElement("div",{className:"text-sm"},"EAR: ",o.toFixed(3)," | Morgue/min: ",c),n.createElement("div",{className:"relative rounded-2xl overflow-hidden border border-slate-200",style:{width:480,height:360}},n.createElement(h(),{ref:t,audio:!1,mirrored:!0,videoConstraints:v,style:{width:480,height:360}})))},A=r(9740);const T=function(){var t=(0,a.o)().t;return n.createElement("div",{className:"flex flex-row"},n.createElement(A.Z,{title:t("vision.title")},n.createElement("p",{className:"mb-4 text-sm text-slate-600"},t("vision.subtitle")),n.createElement(y,null)),n.createElement(A.Z,{title:"Blink Monitoring (Experimental)"},n.createElement(P,null)))}}}]);